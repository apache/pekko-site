<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="Apache Pekko is a toolkit for building highly concurrent, distributed, and resilient message-driven applications for Java and Scala.">
<meta name="generator" content="Paradox, paradox-material-theme=0.6.0, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="Apache Pekko is a toolkit for building highly concurrent, distributed, and resilient message-driven applications for Java and Scala.">
<link rel="shortcut icon" href="../assets/images/pekko_favicon.png">
<title>Learning Pekko Typed from Classic · Apache Pekko Documentation</title>
<link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
<link rel="stylesheet" href="../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../lib/prettify/prettify.css">
<script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="../assets/fonts/font-awesome.css">
<link rel="stylesheet" href="../assets/fonts/material-icons.css">
<link rel="stylesheet" href="../assets/stylesheets/paradox-material-theme.css">
<link rel="stylesheet" href="../assets/stylesheets/pekko-theme.css">
</head>
<body
data-md-color-primary="white"
data-md-color-accent="orange"
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../index.html" title="Apache Pekko Documentation" class="md-header-nav__button md-logo">
<img src="../assets/images/pekko_logo.png" width="24" height="24">
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
Apache Pekko Documentation
</span>
<span class="md-header-nav__topic">
Learning Pekko Typed from Classic
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a href="https://github.com/apache/incubator-pekko"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
apache/incubator-pekko
</div>
</a>

</div>
</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="../index.html" title="Apache Pekko Documentation" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<img src="../assets/images/pekko_logo.png" width="24" height="24">
</a>
<a href="../index.html" title="Apache Pekko Documentation">
Apache Pekko Documentation
</a>
</label>
<div class="md-nav__source">
<a href="https://github.com/apache/incubator-pekko"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
apache/incubator-pekko
</div>
</a>

</div>
<select class="supergroup" name="Language"><option class="group" value="group-scala">Scala</option><option class="group" value="group-java">Java</option></select>
<ul>
  <li><a href="../security/index.html" class="page">Security Announcements</a>
  <ul>
    <li><a href="../security/index.html#receiving-security-advisories" class="header">Receiving Security Advisories</a></li>
    <li><a href="../security/index.html#reporting-vulnerabilities" class="header">Reporting Vulnerabilities</a></li>
    <li><a href="../security/index.html#security-related-documentation" class="header">Security Related Documentation</a></li>
  </ul></li>
  <li><a href="../typed/guide/index.html" class="page">Getting Started Guide</a>
  <ul>
    <li><a href="../typed/guide/introduction.html" class="page">Introduction to Apache Pekko</a></li>
    <li><a href="../typed/guide/actors-motivation.html" class="page">Why modern systems need a new programming model</a></li>
    <li><a href="../typed/guide/actors-intro.html" class="page">How the Actor Model Meets the Needs of Modern, Distributed Systems</a></li>
    <li><a href="../typed/guide/modules.html" class="page">Overview of Apache Pekko libraries and modules</a></li>
    <li><a href="../typed/guide/tutorial.html" class="page">Introduction to the Example</a></li>
    <li><a href="../typed/guide/tutorial_1.html" class="page">Part 1: Actor Architecture</a></li>
    <li><a href="../typed/guide/tutorial_2.html" class="page">Part 2: Creating the First Actor</a></li>
    <li><a href="../typed/guide/tutorial_3.html" class="page">Part 3: Working with Device Actors</a></li>
    <li><a href="../typed/guide/tutorial_4.html" class="page">Part 4: Working with Device Groups</a></li>
    <li><a href="../typed/guide/tutorial_5.html" class="page">Part 5: Querying Device Groups</a></li>
  </ul></li>
  <li><a href="../general/index.html" class="page">General Concepts</a>
  <ul>
    <li><a href="../general/terminology.html" class="page">Terminology, Concepts</a></li>
    <li><a href="../general/actor-systems.html" class="page">Actor Systems</a></li>
    <li><a href="../general/actors.html" class="page">What is an Actor?</a></li>
    <li><a href="../general/supervision.html" class="page">Supervision and Monitoring</a></li>
    <li><a href="../general/addressing.html" class="page">Actor References, Paths and Addresses</a></li>
    <li><a href="../general/remoting.html" class="page">Location Transparency</a></li>
    <li><a href="../general/jmm.html" class="page">Apache Pekko and the Java Memory Model</a></li>
    <li><a href="../general/message-delivery-reliability.html" class="page">Message Delivery Reliability</a></li>
    <li><a href="../general/configuration.html" class="page">Configuration</a></li>
    <li><a href="../general/configuration-reference.html" class="page">Default configuration</a></li>
  </ul></li>
  <li><a href="../typed/index.html" class="page">Actors</a>
  <ul>
    <li><a href="../typed/actors.html" class="page">Introduction to Actors</a></li>
    <li><a href="../typed/actor-lifecycle.html" class="page">Actor lifecycle</a></li>
    <li><a href="../typed/interaction-patterns.html" class="page">Interaction Patterns</a></li>
    <li><a href="../typed/fault-tolerance.html" class="page">Fault Tolerance</a></li>
    <li><a href="../typed/actor-discovery.html" class="page">Actor discovery</a></li>
    <li><a href="../typed/routers.html" class="page">Routers</a></li>
    <li><a href="../typed/stash.html" class="page">Stash</a></li>
    <li><a href="../typed/fsm.html" class="page">Behaviors as finite state machines</a></li>
    <li><a href="../coordinated-shutdown.html" class="page">Coordinated Shutdown</a></li>
    <li><a href="../typed/dispatchers.html" class="page">Dispatchers</a></li>
    <li><a href="../typed/mailboxes.html" class="page">Mailboxes</a></li>
    <li><a href="../typed/testing.html" class="page">Testing</a></li>
    <li><a href="../typed/coexisting.html" class="page">Coexistence</a></li>
    <li><a href="../typed/style-guide.html" class="page">Style guide</a></li>
    <li><a href="../typed/from-classic.html#learning-pekko-typed-from-classic" class="active page">Learning Pekko Typed from Classic</a></li>
  </ul></li>
  <li><a href="../typed/index-cluster.html" class="page">Cluster</a>
  <ul>
    <li><a href="../typed/cluster.html" class="page">Cluster Usage</a></li>
    <li><a href="../typed/cluster-concepts.html" class="page">Cluster Specification</a></li>
    <li><a href="../typed/cluster-membership.html" class="page">Cluster Membership Service</a></li>
    <li><a href="../typed/failure-detector.html" class="page">Phi Accrual Failure Detector</a></li>
    <li><a href="../typed/distributed-data.html" class="page">Distributed Data</a></li>
    <li><a href="../typed/cluster-singleton.html" class="page">Cluster Singleton</a></li>
    <li><a href="../typed/cluster-sharding.html" class="page">Cluster Sharding</a></li>
    <li><a href="../typed/cluster-sharding-concepts.html" class="page">Cluster Sharding concepts</a></li>
    <li><a href="../typed/cluster-sharded-daemon-process.html" class="page">Sharded Daemon Process</a></li>
    <li><a href="../typed/cluster-dc.html" class="page">Multi-DC Cluster</a></li>
    <li><a href="../typed/distributed-pub-sub.html" class="page">Distributed Publish Subscribe in Cluster</a></li>
    <li><a href="../typed/reliable-delivery.html" class="page">Reliable delivery</a></li>
    <li><a href="../serialization.html" class="page">Serialization</a></li>
    <li><a href="../serialization-jackson.html" class="page">Serialization with Jackson</a></li>
    <li><a href="../multi-jvm-testing.html" class="page">Multi JVM Testing</a></li>
    <li><a href="../multi-node-testing.html" class="page">Multi Node Testing</a></li>
    <li><a href="../remoting-artery.html" class="page">Artery Remoting</a></li>
    <li><a href="../remoting.html" class="page">Classic Remoting (Deprecated)</a></li>
    <li><a href="../split-brain-resolver.html" class="page">Split Brain Resolver</a></li>
    <li><a href="../coordination.html" class="page">Coordination</a></li>
    <li><a href="../typed/choosing-cluster.html" class="page">Choosing Pekko Cluster</a></li>
  </ul></li>
  <li><a href="../typed/index-persistence.html" class="page">Persistence (Event Sourcing)</a>
  <ul>
    <li><a href="../typed/persistence.html" class="page">Event Sourcing</a></li>
    <li><a href="../typed/replicated-eventsourcing.html" class="page">Replicated Event Sourcing</a></li>
    <li><a href="../typed/cqrs.html" class="page">CQRS</a></li>
    <li><a href="../typed/persistence-style.html" class="page">Style Guide</a></li>
    <li><a href="../typed/persistence-snapshot.html" class="page">Snapshotting</a></li>
    <li><a href="../typed/persistence-testing.html" class="page">Testing</a></li>
    <li><a href="../typed/persistence-fsm.html" class="page">EventSourced behaviors as finite state machines</a></li>
    <li><a href="../persistence-schema-evolution.html" class="page">Schema Evolution for Event Sourced Actors</a></li>
    <li><a href="../persistence-query.html" class="page">Apache Persistence Query</a></li>
    <li><a href="../persistence-query-leveldb.html" class="page">Persistence Query for LevelDB</a></li>
    <li><a href="../persistence-plugins.html" class="page">Persistence Plugins</a></li>
    <li><a href="../persistence-journals.html" class="page">Persistence - Building a storage backend</a></li>
    <li><a href="../typed/replicated-eventsourcing-examples.html" class="page">Replicated Event Sourcing Examples</a></li>
  </ul></li>
  <li><a href="../typed/index-persistence-durable-state.html" class="page">Persistence (Durable State)</a>
  <ul>
    <li><a href="../typed/durable-state/persistence.html" class="page">Durable State</a></li>
    <li><a href="../typed/durable-state/persistence-style.html" class="page">Style Guide</a></li>
    <li><a href="../typed/durable-state/cqrs.html" class="page">CQRS</a></li>
    <li><a href="../durable-state/persistence-query.html" class="page">Persistence Query</a></li>
  </ul></li>
  <li><a href="../stream/index.html" class="page">Streams</a>
  <ul>
    <li><a href="../stream/index.html#module-info" class="header">Module info</a></li>
    <li><a href="../stream/stream-introduction.html" class="page">Introduction</a></li>
    <li><a href="../stream/stream-quickstart.html" class="page">Streams Quickstart Guide</a></li>
    <li><a href="../general/stream/stream-design.html" class="page">Design Principles behind Apache Pekko Streams</a></li>
    <li><a href="../stream/stream-flows-and-basics.html" class="page">Basics and working with Flows</a></li>
    <li><a href="../stream/stream-graphs.html" class="page">Working with Graphs</a></li>
    <li><a href="../stream/stream-composition.html" class="page">Modularity, Composition and Hierarchy</a></li>
    <li><a href="../stream/stream-rate.html" class="page">Buffers and working with rate</a></li>
    <li><a href="../stream/stream-context.html" class="page">Context Propagation</a></li>
    <li><a href="../stream/stream-dynamic.html" class="page">Dynamic stream handling</a></li>
    <li><a href="../stream/stream-customize.html" class="page">Custom stream processing</a></li>
    <li><a href="../stream/futures-interop.html" class="page">Futures interop</a></li>
    <li><a href="../stream/actor-interop.html" class="page">Actors interop</a></li>
    <li><a href="../stream/reactive-streams-interop.html" class="page">Reactive Streams Interop</a></li>
    <li><a href="../stream/stream-error.html" class="page">Error Handling in Streams</a></li>
    <li><a href="../stream/stream-io.html" class="page">Working with streaming IO</a></li>
    <li><a href="../stream/stream-refs.html" class="page">StreamRefs - Reactive Streams over the network</a></li>
    <li><a href="../stream/stream-parallelism.html" class="page">Pipelining and Parallelism</a></li>
    <li><a href="../stream/stream-testkit.html" class="page">Testing streams</a></li>
    <li><a href="../stream/stream-substream.html" class="page">Substreams</a></li>
    <li><a href="../stream/stream-cookbook.html" class="page">Streams Cookbook</a></li>
    <li><a href="../general/stream/stream-configuration.html" class="page">Configuration</a></li>
    <li><a href="../stream/operators/index.html" class="page">Operators</a></li>
  </ul></li>
  <li><a href="../discovery/index.html" class="page">Discovery</a>
  <ul>
    <li><a href="../discovery/index.html#module-info" class="header">Module info</a></li>
    <li><a href="../discovery/index.html#how-it-works" class="header">How it works</a></li>
    <li><a href="../discovery/index.html#discovery-method-dns" class="header">Discovery Method: DNS</a></li>
    <li><a href="../discovery/index.html#discovery-method-configuration" class="header">Discovery Method: Configuration</a></li>
    <li><a href="../discovery/index.html#discovery-method-aggregate-multiple-discovery-methods" class="header">Discovery Method: Aggregate multiple discovery methods</a></li>
    <li><a href="../discovery/index.html#migrating-from-pekko-management-discovery-before-1-0-0-" class="header">Migrating from Pekko Management Discovery (before 1.0.0)</a></li>
  </ul></li>
  <li><a href="../index-utilities.html" class="page">Utilities</a>
  <ul>
    <li><a href="../typed/logging.html" class="page">Logging</a></li>
    <li><a href="../common/circuitbreaker.html" class="page">Circuit Breaker</a></li>
    <li><a href="../futures.html" class="page">Futures patterns</a></li>
    <li><a href="../typed/extending.html" class="page">Extending Apache Pekko</a></li>
  </ul></li>
  <li><a href="../common/other-modules.html" class="page">Other Apache Pekko modules</a>
  <ul>
    <li><a href="../common/other-modules.html#" class="header"><a href="https://pekko.apache.org/docs/pekko-http/current/">Pekko HTTP</a></a></li>
    <li><a href="../common/other-modules.html#" class="header"><a href="https://pekko.apache.org/docs/pekko-grpc/current/">Pekko gRPC</a></a></li>
    <li><a href="../common/other-modules.html#" class="header"><a href="https://pekko.apache.org/docs/pekko-connectors/current/">Pekko Connectors</a></a></li>
    <li><a href="../common/other-modules.html#" class="header"><a href="https://pekko.apache.org/docs/pekko-connectors-kafka/current/">Pekko Kafka Connector</a></a></li>
    <li><a href="../common/other-modules.html#" class="header"><a href="https://pekko.apache.org/docs/pekko-projection/current/">Pekko Projections</a></a></li>
    <li><a href="../common/other-modules.html#" class="header"><a href="https://pekko.apache.org/docs/pekko-persistence-cassandra/current/">Cassandra Plugin for Pekko Persistence</a></a></li>
    <li><a href="../common/other-modules.html#" class="header"><a href="https://pekko.apache.org/docs/pekko-persistence-jdbc/current/">JDBC Plugin for Pekko Persistence</a></a></li>
    <li><a href="../common/other-modules.html#" class="header"><a href="https://pekko.apache.org/docs/pekko-persistence-r2dbc/current/">R2DBC Plugin for Pekko Persistence</a></a></li>
    <li><a href="../common/other-modules.html#" class="header"><a href="https://pekko.apache.org/docs/pekko-persistence-spanner/current/">Google Cloud Spanner Plugin for Pekko Persistence</a></a></li>
    <li><a href="../common/other-modules.html#apache-pekko-management" class="header">Apache Pekko Management</a></li>
  </ul></li>
  <li><a href="../additional/deploy.html" class="page">Package, Deploy and Run</a>
  <ul>
    <li><a href="../additional/packaging.html" class="page">Packaging</a></li>
    <li><a href="../additional/operations.html" class="page">Operating a Cluster</a></li>
    <li><a href="../additional/deploying.html" class="page">Deploying</a></li>
    <li><a href="../additional/rolling-updates.html" class="page">Rolling Updates</a></li>
  </ul></li>
  <li><a href="../project/index.html" class="page">Project Information</a>
  <ul>
    <li><a href="../common/binary-compatibility-rules.html" class="page">Binary Compatibility Rules</a></li>
    <li><a href="../project/scala3.html" class="page">Scala 3 support</a></li>
    <li><a href="../project/downstream-upgrade-strategy.html" class="page">Downstream upgrade strategy</a></li>
    <li><a href="../common/may-change.html" class="page">Modules marked &ldquo;May Change&rdquo;</a></li>
    <li><a href="../additional/ide.html" class="page">IDE Tips</a></li>
    <li><a href="../project/immutable.html" class="page">Immutability using Lombok</a></li>
    <li><a href="../additional/osgi.html" class="page">Apache Pekko in OSGi</a></li>
    <li><a href="../project/migration-guides.html" class="page">Migration Guides</a></li>
    <li><a href="../project/rolling-update.html" class="page">Rolling Updates and Versions</a></li>
    <li><a href="../project/issue-tracking.html" class="page">Issue Tracking</a></li>
    <li><a href="../project/licenses.html" class="page">Licenses</a></li>
    <li><a href="../additional/faq.html" class="page">Frequently Asked Questions</a></li>
    <li><a href="../additional/books.html" class="page">Books and Videos</a></li>
    <li><a href="../project/examples.html" class="page">Example projects</a></li>
    <li><a href="../project/links.html" class="page">Project</a></li>
  </ul></li>
  <li><a href="../index-classic.html" class="page">Pekko Classic</a>
  <ul>
    <li><a href="../index-actors.html" class="page">Classic Actors</a></li>
    <li><a href="../index-cluster.html" class="page">Classic Clustering</a></li>
    <li><a href="../index-network.html" class="page">Classic Networking</a></li>
    <li><a href="../index-utilities-classic.html" class="page">Classic Utilities</a></li>
  </ul></li>
</ul>

<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../typed/from-classic.html#learning-pekko-typed-from-classic" class="header">Learning Pekko Typed from Classic</a>
  <ul>
    <li><a href="../typed/from-classic.html#dependencies" class="header">Dependencies</a></li>
    <li><a href="../typed/from-classic.html#package-names" class="header">Package names</a></li>
    <li><a href="../typed/from-classic.html#actor-definition" class="header">Actor definition</a></li>
    <li><a href="../typed/from-classic.html#actorof-and-props" class="header">actorOf and Props</a></li>
    <li><a href="../typed/from-classic.html#actorref" class="header">ActorRef</a></li>
    <li><a href="../typed/from-classic.html#actorsystem" class="header">ActorSystem</a></li>
    <li><a href="../typed/from-classic.html#become" class="header">become</a></li>
    <li><a href="../typed/from-classic.html#sender" class="header">sender</a></li>
    <li><a href="../typed/from-classic.html#parent" class="header">parent</a></li>
    <li><a href="../typed/from-classic.html#supervision" class="header">Supervision</a></li>
    <li><a href="../typed/from-classic.html#lifecycle-hooks" class="header">Lifecycle hooks</a></li>
    <li><a href="../typed/from-classic.html#watch" class="header">watch</a></li>
    <li><a href="../typed/from-classic.html#stopping" class="header">Stopping</a></li>
    <li><a href="../typed/from-classic.html#actorselection" class="header">ActorSelection</a></li>
    <li><a href="../typed/from-classic.html#ask" class="header">ask</a></li>
    <li><a href="../typed/from-classic.html#pipeto" class="header">pipeTo</a></li>
    <li><a href="../typed/from-classic.html#actorcontext-children" class="header">ActorContext.children</a></li>
    <li><a href="../typed/from-classic.html#remote-deployment" class="header">Remote deployment</a></li>
    <li><a href="../typed/from-classic.html#routers" class="header">Routers</a></li>
    <li><a href="../typed/from-classic.html#fsm" class="header">FSM</a></li>
    <li><a href="../typed/from-classic.html#timers" class="header">Timers</a></li>
    <li><a href="../typed/from-classic.html#stash" class="header">Stash</a></li>
    <li><a href="../typed/from-classic.html#persistentactor" class="header">PersistentActor</a></li>
    <li><a href="../typed/from-classic.html#asynchronous-testing" class="header">Asynchronous Testing</a></li>
    <li><a href="../typed/from-classic.html#synchronous-testing" class="header">Synchronous Testing</a></li>
  </ul></li>
</ul>
</nav>


<ul class="md-nav__list md-nav__links">
<li class="md-nav__item"><a href="https://apache.org"><i class="md-icon">link</i> Apache Software Foundation</a></li>
<li class="md-nav__item"><a href="https://apache.org/licenses/"><i class="md-icon">link</i>&nbsp;License</a></li>
<li class="md-nav__item"><a href="https://apache.org/security/"><i class="md-icon">link</i>&nbsp;Security</a></li>
<li class="md-nav__item"><a href="https://www.apache.org/foundation/sponsorship.html"><i class="md-icon">link</i>&nbsp;Donate</a></li>
<li class="md-nav__item"><a href="https://www.apache.org/foundation/thanks.html"><i class="md-icon">link</i>&nbsp;Thanks</a></li>
</ul>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 0.0.0+26605-0f20b284+20230301-2309*
</label>
</li>
</ul>

</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../typed/from-classic.html#learning-pekko-typed-from-classic" class="header">Learning Pekko Typed from Classic</a>
  <ul>
    <li><a href="../typed/from-classic.html#dependencies" class="header">Dependencies</a></li>
    <li><a href="../typed/from-classic.html#package-names" class="header">Package names</a></li>
    <li><a href="../typed/from-classic.html#actor-definition" class="header">Actor definition</a></li>
    <li><a href="../typed/from-classic.html#actorof-and-props" class="header">actorOf and Props</a></li>
    <li><a href="../typed/from-classic.html#actorref" class="header">ActorRef</a></li>
    <li><a href="../typed/from-classic.html#actorsystem" class="header">ActorSystem</a></li>
    <li><a href="../typed/from-classic.html#become" class="header">become</a></li>
    <li><a href="../typed/from-classic.html#sender" class="header">sender</a></li>
    <li><a href="../typed/from-classic.html#parent" class="header">parent</a></li>
    <li><a href="../typed/from-classic.html#supervision" class="header">Supervision</a></li>
    <li><a href="../typed/from-classic.html#lifecycle-hooks" class="header">Lifecycle hooks</a></li>
    <li><a href="../typed/from-classic.html#watch" class="header">watch</a></li>
    <li><a href="../typed/from-classic.html#stopping" class="header">Stopping</a></li>
    <li><a href="../typed/from-classic.html#actorselection" class="header">ActorSelection</a></li>
    <li><a href="../typed/from-classic.html#ask" class="header">ask</a></li>
    <li><a href="../typed/from-classic.html#pipeto" class="header">pipeTo</a></li>
    <li><a href="../typed/from-classic.html#actorcontext-children" class="header">ActorContext.children</a></li>
    <li><a href="../typed/from-classic.html#remote-deployment" class="header">Remote deployment</a></li>
    <li><a href="../typed/from-classic.html#routers" class="header">Routers</a></li>
    <li><a href="../typed/from-classic.html#fsm" class="header">FSM</a></li>
    <li><a href="../typed/from-classic.html#timers" class="header">Timers</a></li>
    <li><a href="../typed/from-classic.html#stash" class="header">Stash</a></li>
    <li><a href="../typed/from-classic.html#persistentactor" class="header">PersistentActor</a></li>
    <li><a href="../typed/from-classic.html#asynchronous-testing" class="header">Asynchronous Testing</a></li>
    <li><a href="../typed/from-classic.html#synchronous-testing" class="header">Synchronous Testing</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#learning-pekko-typed-from-classic" name="learning-pekko-typed-from-classic" class="anchor"><span class="anchor-link"></span></a>Learning Pekko Typed from Classic</h1>
<p>Pekko Classic is the original Actor APIs, which have been improved by more type safe and guided Actor APIs, known as Pekko Typed.</p>
<p>If you already know the classic Actor APIs and would like to learn Pekko Typed, this reference is a good resource. Many concepts are the same and this page tries to highlight differences and how to do certain things in Typed compared to classic.</p>
<p>You should probably learn some of the basics of Pekko Typed to see how it looks like before diving into the differences and details described here. A good starting point for that is the <a href="guide/tutorial_3.html">IoT example</a> in the Getting Started Guide or the examples shown in <a href="actors.html">Introduction to Actors</a>.</p>
<p>Note that Pekko Classic is still fully supported and existing applications can continue to use the classic APIs. It is also possible to use Pekko Typed together with classic actors within the same ActorSystem, see <a href="coexisting.html">coexistence</a>. For new projects we recommend using the new Actor APIs.</p>
<h2><a href="#dependencies" name="dependencies" class="anchor"><span class="anchor-link"></span></a>Dependencies</h2>
<p>The dependencies of the Typed modules are named by adding <code>-typed</code> suffix of the corresponding classic module, with a few exceptions.</p>
<p>For example <code>pekko-cluster-typed</code>:</p><dl class="dependency"><dt>sbt</dt><dd><pre class="prettyprint"><code class="language-scala">val PekkoVersion = "0.0.0+26605-0f20b284+20230301-2309-SNAPSHOT"
libraryDependencies += "org.apache.pekko" %% "pekko-cluster-typed" % PekkoVersion</code></pre></dd><dt>Maven</dt><dd><pre class="prettyprint"><code class="language-xml">&lt;properties&gt;
  &lt;scala.binary.version&gt;2.13&lt;/scala.binary.version&gt;
&lt;/properties&gt;
&lt;dependencyManagement&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.pekko&lt;/groupId&gt;
      &lt;artifactId&gt;pekko-bom_${scala.binary.version}&lt;/artifactId&gt;
      &lt;version&gt;0.0.0+26605-0f20b284+20230301-2309-SNAPSHOT&lt;/version&gt;
      &lt;type&gt;pom&lt;/type&gt;
      &lt;scope&gt;import&lt;/scope&gt;
    &lt;/dependency&gt
  &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;
&lt;dependencies&gt
  &lt;dependency&gt;
    &lt;groupId&gt;org.apache.pekko&lt;/groupId&gt;
    &lt;artifactId&gt;pekko-cluster-typed_${scala.binary.version}&lt;/artifactId&gt;
  &lt;/dependency&gt
&lt;/dependencies&gt;</code></pre></dd><dt>Gradle</dt><dd><pre class="prettyprint"><code class="language-gradle">def versions = [
  ScalaBinary: "2.13"
]
dependencies {
  implementation platform("org.apache.pekko:pekko-bom_${versions.ScalaBinary}:0.0.0+26605-0f20b284+20230301-2309-SNAPSHOT")

  implementation "org.apache.pekko:pekko-cluster-typed_${versions.ScalaBinary}"
}</code></pre></dd></dl>
<p>Artifact names:</p>
<table>
  <thead>
    <tr>
      <th>Classic </th>
      <th>Typed </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>pekko-actor </td>
      <td>pekko-actor-typed </td>
    </tr>
    <tr>
      <td>pekko-cluster </td>
      <td>pekko-cluster-typed </td>
    </tr>
    <tr>
      <td>pekko-cluster-sharding </td>
      <td>pekko-cluster-sharding-typed </td>
    </tr>
    <tr>
      <td>pekko-cluster-tools </td>
      <td>pekko-cluster-typed </td>
    </tr>
    <tr>
      <td>pekko-distributed-data </td>
      <td>pekko-cluster-typed </td>
    </tr>
    <tr>
      <td>pekko-persistence </td>
      <td>pekko-persistence-typed </td>
    </tr>
    <tr>
      <td>pekko-stream </td>
      <td>pekko-stream-typed </td>
    </tr>
    <tr>
      <td>pekko-testkit </td>
      <td>pekko-actor-testkit-typed </td>
    </tr>
  </tbody>
</table>
<p>Cluster Singleton and Distributed Data are included in <code>pekko-cluster-typed</code>.</p>
<p>Artifacts not listed in above table don&rsquo;t have a specific API for Pekko Typed.</p>
<h2><a href="#package-names" name="package-names" class="anchor"><span class="anchor-link"></span></a>Package names</h2>
<p>The convention of the package names in Pekko Typed is to add <code>typed.scaladsl</code> and <code>typed.javadsl</code> to the corresponding Pekko classic package name. <code>scaladsl</code> and <code>javadsl</code> is the convention to separate Scala and Java APIs, which is familiar from Pekko Streams.</p>
<p>Examples of a few package names:</p>
<table>
  <thead>
    <tr>
      <th>Classic </th>
      <th>Typed for Scala </th>
      <th>Typed for Java </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>org.apache.pekko.actor </td>
      <td>org.apache.pekko.actor.typed.scaladsl </td>
      <td>org.apache.pekko.actor.typed.javadsl </td>
    </tr>
    <tr>
      <td>org.apache.pekko.cluster </td>
      <td>org.apache.pekko.cluster.typed </td>
      <td>org.apache.pekko.cluster.typed </td>
    </tr>
    <tr>
      <td>org.apache.pekko.cluster.sharding </td>
      <td>org.apache.pekko.cluster.sharding.typed.scaladsl </td>
      <td>org.apache.pekko.cluster.sharding.typed.javadsl </td>
    </tr>
    <tr>
      <td>org.apache.pekko.persistence </td>
      <td>org.apache.pekko.persistence.typed.scaladsl </td>
      <td>org.apache.pekko.persistence.typed.javadsl </td>
    </tr>
  </tbody>
</table>
<h2><a href="#actor-definition" name="actor-definition" class="anchor"><span class="anchor-link"></span></a>Actor definition</h2>
<p>A classic actor is defined by a class extending <span class="group-scala"><code>org.apache.pekko.actor.Actor</code></span><span class="group-java"><code>org.apache.pekko.actor.AbstractActor</code></span>.</p>
<p>An actor in Typed is defined by a class extending <span class="group-scala"><code>org.apache.pekko.actor.typed.scaladsl.AbstractBehavior</code></span><span class="group-java"><code>org.apache.pekko.actor.typed.javadsl.AbstractBehavior</code></span>.</p>
<p>It&rsquo;s also possible to define an actor in Typed from functions instead of extending a class. This is called the <a href="style-guide.html#functional-versus-object-oriented-style">functional style</a>.</p>
<p>Classic HelloWorld actor:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/actor-typed-tests/src/test/scala/docs/org/apache/pekko/typed/fromclassic/ClassicSample.scala#L17-L44" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import org.apache.pekko
import pekko.actor.Actor
import pekko.actor.ActorLogging
import pekko.actor.Props

object HelloWorld {
  final case class Greet(whom: String)
  final case class Greeted(whom: String)

  def props(): Props =
    Props(new HelloWorld)
}

class HelloWorld extends Actor with ActorLogging {
  import HelloWorld._

  override def receive: Receive = {
    case Greet(whom) =&gt;
      log.info(&quot;Hello {}!&quot;, whom)
      sender() ! Greeted(whom)
  }
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/actor-typed-tests/src/test/java/jdocs/org/apache/pekko/typed/fromclassic/ClassicSample.java#L17-L60" target="_blank" title="Go to snippet source">source</a><code class="language-java">import org.apache.pekko.actor.AbstractActor;
import org.apache.pekko.actor.Props;
import org.apache.pekko.event.Logging;
import org.apache.pekko.event.LoggingAdapter;

public class HelloWorld extends AbstractActor {

  public static final class Greet {
    public final String whom;

    public Greet(String whom) {
      this.whom = whom;
    }
  }

  public static final class Greeted {
    public final String whom;

    public Greeted(String whom) {
      this.whom = whom;
    }
  }

  public static Props props() {
    return Props.create(HelloWorld.class, HelloWorld::new);
  }

  private final LoggingAdapter log = Logging.getLogger(getContext().getSystem(), this);

  @Override
  public Receive createReceive() {
    return receiveBuilder().match(Greet.class, this::onGreet).build();
  }

  private void onGreet(Greet command) {
    log.info(&quot;Hello {}!&quot;, command.whom);
    getSender().tell(new Greeted(command.whom), getSelf());
  }
}</code></pre></dd>
</dl>
<p>Typed HelloWorld actor:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/actor-typed-tests/src/test/scala/docs/org/apache/pekko/typed/fromclassic/TypedSample.scala#L17-L45" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import org.apache.pekko
import pekko.actor.typed.ActorRef
import pekko.actor.typed.Behavior
import pekko.actor.typed.scaladsl.AbstractBehavior
import pekko.actor.typed.scaladsl.ActorContext
import pekko.actor.typed.scaladsl.Behaviors

object HelloWorld {
  final case class Greet(whom: String, replyTo: ActorRef[Greeted])
  final case class Greeted(whom: String, from: ActorRef[Greet])

  def apply(): Behavior[HelloWorld.Greet] =
    Behaviors.setup(context =&gt; new HelloWorld(context))
}

class HelloWorld(context: ActorContext[HelloWorld.Greet]) extends AbstractBehavior[HelloWorld.Greet](context) {
  import HelloWorld._

  override def onMessage(message: Greet): Behavior[Greet] = {
    context.log.info(&quot;Hello {}!&quot;, message.whom)
    message.replyTo ! Greeted(message.whom, context.self)
    this
  }
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/actor-typed-tests/src/test/java/jdocs/org/apache/pekko/typed/fromclassic/TypedSample.java#L17-L72" target="_blank" title="Go to snippet source">source</a><code class="language-java">import org.apache.pekko.actor.typed.ActorRef;
import org.apache.pekko.actor.typed.Behavior;
import org.apache.pekko.actor.typed.javadsl.AbstractBehavior;
import org.apache.pekko.actor.typed.javadsl.ActorContext;
import org.apache.pekko.actor.typed.javadsl.Behaviors;
import org.apache.pekko.actor.typed.javadsl.Receive;

import java.util.HashMap;
import java.util.Map;

public class HelloWorld extends AbstractBehavior&lt;HelloWorld.Greet&gt; {

  public static final class Greet {
    public final String whom;
    public final ActorRef&lt;Greeted&gt; replyTo;

    public Greet(String whom, ActorRef&lt;Greeted&gt; replyTo) {
      this.whom = whom;
      this.replyTo = replyTo;
    }
  }

  public static final class Greeted {
    public final String whom;
    public final ActorRef&lt;Greet&gt; from;

    public Greeted(String whom, ActorRef&lt;Greet&gt; from) {
      this.whom = whom;
      this.from = from;
    }
  }

  public static Behavior&lt;Greet&gt; create() {
    return Behaviors.setup(HelloWorld::new);
  }

  private HelloWorld(ActorContext&lt;Greet&gt; context) {
    super(context);
  }

  @Override
  public Receive&lt;Greet&gt; createReceive() {
    return newReceiveBuilder().onMessage(Greet.class, this::onGreet).build();
  }

  private Behavior&lt;Greet&gt; onGreet(Greet command) {
    getContext().getLog().info(&quot;Hello {}!&quot;, command.whom);
    command.replyTo.tell(new Greeted(command.whom, getContext().getSelf()));
    return this;
  }
}</code></pre></dd>
</dl>
<p>Why is it called <code>Behavior</code> and not <code>Actor</code>?</p>
<p>In Typed, the <code>Behavior</code> defines how to handle incoming messages. After processing a message, a different <code>Behavior</code> may be returned for processing the next message. This means that an actor is started with an initial <code>Behavior</code> and may change <code>Behavior</code> over its lifecycle. This is described more in the section about <a href="from-classic.html#become">become</a>.</p>
<p>Note that the <code>Behavior</code> has a type parameter describing the type of messages that it can handle. This information is not defined explicitly for a classic actor.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../actors.html#defining-an-actor-class">Classic</a></li>
  <li><a href="actors.html#first-example">Typed</a></li>
</ul>
<h2><a href="#actorof-and-props" name="actorof-and-props" class="anchor"><span class="anchor-link"></span></a>actorOf and Props</h2>
<p>A classic actor is started with the <code>actorOf</code> method of the <code>ActorContext</code> or <code>ActorSystem</code>.</p>
<p>Corresponding method in Typed is called <code>spawn</code> in the <span class="group-scala"><code>org.apache.pekko.actor.typed.scaladsl.ActorContext</code></span><span class="group-java"><code>org.apache.pekko.actor.typed.javadsl.ActorContext</code></span>.</p>
<p>There is no <code>spawn</code> method in the <span class="group-scala"><code>org.apache.pekko.actor.typed.scaladsl.ActorSystem</code></span><span class="group-java"><code>org.apache.pekko.actor.typed.javadsl.ActorSystem</code></span> for creating top level actors. Instead, there is a single top level actor defined by a user guardian <code>Behavior</code> that is given when starting the <code>ActorSystem</code>. Other actors are started as children of that user guardian actor or children of other actors in the actor hierarchy. This is explained more in <a href="from-classic.html#actorsystem">ActorSystem</a>.</p>
<p>Note that when mixing classic and typed and have a classic system, spawning top level actors from the side is possible, see <a href="coexisting.html#top-level-typed-actor-classic-system">Coexistence</a>.</p>
<p>The <code>actorOf</code> method takes an <code>org.apache.pekko.actor.Props</code> parameter, which is like a factory for creating the actor instance, and it&rsquo;s also used when creating a new instance when the actor is restarted. The <code>Props</code> may also define additional properties such as which dispatcher to use for the actor.</p>
<p>In typed, the <code>spawn</code> method creates an actor directly from a given <code>Behavior</code> without using a <code>Props</code> factory. It does however accept an optional <code>org.apache.pekko.actor.typed.Props</code> for specifying Actor metadata. The factory aspect is instead defined via <code>Behaviors.setup</code> when using the object-oriented style with a class extending <code>AbstractBehavior</code>. For the function style there is typically no need for the factory.</p>
<p>Additional properties such as which dispatcher to use for the actor can still be given via an optional <code>org.apache.pekko.actor.typed.Props</code> parameter of the <code>spawn</code> method.</p>
<p>The <code>name</code> parameter of <code>actorOf</code> is optional and if not defined the actor will have a generated name. Corresponding in Typed is achieved with the <code>spawnAnonymous</code> method.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../actors.html#creating-actors-with-props">Classic</a></li>
  <li><a href="actor-lifecycle.html#creating-actors">Typed</a></li>
</ul>
<h2><a href="#actorref" name="actorref" class="anchor"><span class="anchor-link"></span></a>ActorRef</h2>
<p><code>org.apache.pekko.actor.ActorRef</code> has its correspondence in <code>org.apache.pekko.actor.typed.ActorRef</code>. The difference being that the latter has a type parameter describing which messages the actor can handle. This information is not defined for a classic actor and you can send any type of message to a classic <code>ActorRef</code> even though the actor may not understand it.</p>
<h2><a href="#actorsystem" name="actorsystem" class="anchor"><span class="anchor-link"></span></a>ActorSystem</h2>
<p><code>org.apache.pekko.actor.ActorSystem</code> has its correspondence in <code>org.apache.pekko.actor.typed.ActorSystem</code>. One difference is that when creating an <code>ActorSystem</code> in Typed you give it a <code>Behavior</code> that will be used as the top level actor, also known as the user guardian.</p>
<p>Additional actors for an application are created from the user guardian alongside performing the initialization of Pekko components such as Cluster Sharding. In contrast, in a classic <code>ActorSystem</code>, such initialization is typically performed from the &ldquo;outside&rdquo;.</p>
<p>The <code>actorOf</code> method of the classic <code>ActorSystem</code> is typically used to create a few (or many) top level actors. The <code>ActorSystem</code> in Typed doesn&rsquo;t have that capability. Instead, such actors are started as children of the user guardian actor or children of other actors in the actor hierarchy. The rationale for this is partly about consistency. In a typed system you can’t create children to an arbitrary actor from anywhere in your app without messaging it, so this will also hold true for the user guardian actor. That noted, in cases where you do need to spawn outside of this guardian then you can use the <a href="actor-lifecycle.html#spawnprotocol"><code>SpawnProtocol</code></a> to spawn as needed.</p>
<h2><a href="#become" name="become" class="anchor"><span class="anchor-link"></span></a>become</h2>
<p>A classic actor can change its message processing behavior by using <code>become</code> in <code>ActorContext</code>. In Typed this is done by returning a new <code>Behavior</code> after processing a message. The returned <code>Behavior</code> will be used for the next received message.</p>
<p>There is no correspondence to <code>unbecome</code> in Typed. Instead you must explicitly keep track of and return the &ldquo;previous&rdquo; <code>Behavior</code>.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../actors.html#actor-hotswap">Classic</a></li>
</ul>
<h2><a href="#sender" name="sender" class="anchor"><span class="anchor-link"></span></a>sender</h2>
<p>There is no <span class="group-scala"><code>sender()</code></span><span class="group-java"><code>getSender()</code></span> in Typed. Instead you have to explicitly include an <code>ActorRef</code> representing the sender—or rather representing where to send a reply to—in the messages.</p>
<p>The reason for not having an implicit sender in Typed is that it wouldn&rsquo;t be possible to know the type for the sender <span class="group-scala"><code>ActorRef[T]</code></span><span class="group-java"><code>ActorRef&lt;T&gt;</code></span> at compile time. It&rsquo;s also much better to define this explicitly in the messages as it becomes more clear what the message protocol expects.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../actors.html#actors-tell-sender">Classic</a></li>
  <li><a href="interaction-patterns.html#request-response">Typed</a></li>
</ul>
<h2><a href="#parent" name="parent" class="anchor"><span class="anchor-link"></span></a>parent</h2>
<p>There is no <span class="group-scala"><code>parent</code></span><span class="group-java"><code>getParent</code></span> in Typed. Instead you have to explicitly include the <code>ActorRef</code> of the parent as a parameter when constructing the <code>Behavior</code>.</p>
<p>The reason for not having a parent in Typed is that it wouldn&rsquo;t be possible to know the type for the parent <span class="group-scala"><code>ActorRef[T]</code></span><span class="group-java"><code>ActorRef&lt;T&gt;</code></span> at compile time without having an additional type parameter in the <code>Behavior</code>. For testing purposes it&rsquo;s also better to pass in the <code>parent</code> since it can be replaced by a probe or being stubbed out in tests.</p>
<h2><a href="#supervision" name="supervision" class="anchor"><span class="anchor-link"></span></a>Supervision</h2>
<p>An important difference between classic and typed is that in typed, actors are stopped by default if an exception is thrown and no supervision strategy is defined. In contrast, in classic, by default, actors are restarted.</p>
<p>In classic actors the supervision strategy for child actors are defined by overriding the <code>supervisorStrategy</code> method in the parent actor.</p>
<p>In Typed the supervisor strategy is defined by wrapping the <code>Behavior</code> of the child actor with <code>Behaviors.supervise</code>.</p>
<p>The classic <code>BackoffSupervisor</code> is supported by <code>SupervisorStrategy.restartWithBackoff</code> as an ordinary <code>SupervisorStrategy</code> in Typed.</p>
<p><code>SupervisorStrategy.Escalate</code> isn&rsquo;t supported in Typed, but similar can be achieved as described in <a href="fault-tolerance.html#bubble-failures-up-through-the-hierarchy">Bubble failures up through the hierarchy</a>.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../fault-tolerance.html">Classic</a></li>
  <li><a href="fault-tolerance.html">Typed</a></li>
</ul>
<h2><a href="#lifecycle-hooks" name="lifecycle-hooks" class="anchor"><span class="anchor-link"></span></a>Lifecycle hooks</h2>
<p>Classic actors have methods <code>preStart</code>, <code>preRestart</code>, <code>postRestart</code> and <code>postStop</code> that can be overridden to act on changes to the actor&rsquo;s lifecycle.</p>
<p>This is supported with corresponding <code>PreRestart</code> and <code>PostStop</code> signal messages in Typed. There are no <code>PreStart</code> and <code>PostRestart</code> signals because such action can be done from <code>Behaviors.setup</code> or the constructor of the <code>AbstractBehavior</code> class.</p>
<p>Note that in classic, the <code>postStop</code> lifecycle hook is also called when the actor is restarted. That is not the case in Typed, only the <code>PreRestart</code> signal is emitted. If you need to do resource cleanup on both restart and stop, you have to do that for both <code>PreRestart</code> and <code>PostStop</code>.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../actors.html#start-hook">Classic</a></li>
  <li><a href="fault-tolerance.html#the-prerestart-signal">Typed</a></li>
</ul>
<h2><a href="#watch" name="watch" class="anchor"><span class="anchor-link"></span></a>watch</h2>
<p><code>watch</code> and the <code>Terminated</code> message are pretty much the same, with some additional capabilities in Typed.</p>
<p><code>Terminated</code> is a signal in Typed since it is a different type than the declared message type of the <code>Behavior</code>.</p>
<p>The <code>watchWith</code> method of the <code>ActorContext</code> in Typed can be used to send a message instead of the <code>Terminated</code> signal.</p>
<p>When watching child actors it&rsquo;s possible to see if the child terminated voluntarily or due to a failure via the <code>ChildFailed</code> signal, which is a subclass of <code>Terminated</code>.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../actors.html#deathwatch">Classic</a></li>
  <li><a href="actor-lifecycle.html#watching-actors">Typed</a></li>
</ul>
<h2><a href="#stopping" name="stopping" class="anchor"><span class="anchor-link"></span></a>Stopping</h2>
<p>Classic actors can be stopped with the <code>stop</code> method of <code>ActorContext</code> or <code>ActorSystem</code>. In Typed an actor stops itself by returning <code>Behaviors.stopped</code>. There is also a <code>stop</code> method in the <code>ActorContext</code> but it can only be used for stopping direct child actors and not any arbitrary actor.</p>
<p><code>PoisonPill</code> is not supported in Typed. Instead, if you need to request an actor to stop you should define a message that the actor understands and let it return <code>Behaviors.stopped</code> when receiving that message.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../actors.html#stopping-actors">Classic</a></li>
  <li><a href="actor-lifecycle.html#stopping-actors">Typed</a></li>
</ul>
<h2><a href="#actorselection" name="actorselection" class="anchor"><span class="anchor-link"></span></a>ActorSelection</h2>
<p><code>ActorSelection</code> isn&rsquo;t supported in Typed. Instead the <a href="actor-discovery.html">Receptionist</a> is supposed to be used for finding actors by a registered key.</p>
<p><code>ActorSelection</code> can be used for sending messages to a path without having an <code>ActorRef</code> of the destination. Note that a <a href="routers.html#group-router">Group Router</a> can be used for that.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../actors.html#actorselection">Classic</a></li>
  <li><a href="actor-discovery.html">Typed</a></li>
</ul>
<h2><a href="#ask" name="ask" class="anchor"><span class="anchor-link"></span></a>ask</h2>
<p>The classic <code>ask</code> pattern returns a <span class="group-scala"><code>Future</code></span><span class="group-java"><code>CompletionStage</code></span> for the response.</p>
<p>Corresponding <code>ask</code> exists in Typed and is good when the requester itself isn&rsquo;t an actor. It is located in <span class="group-scala"><code>org.apache.pekko.actor.typed.scaladsl.AskPattern</code></span><span class="group-java"><code>org.apache.pekko.actor.typed.javadsl.AskPattern</code></span>.</p>
<p>When the requester is an actor it is better to use the <code>ask</code> method of the <code>ActorContext</code> in Typed. It has the advantage of not having to mix <span class="group-scala"><code>Future</code></span><span class="group-java"><code>CompletionStage</code></span> callbacks that are running on different threads with actor code.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../actors.html#actors-ask">Classic</a></li>
  <li><a href="interaction-patterns.html#request-response-with-ask-between-two-actors">Typed</a></li>
</ul>
<h2><a href="#pipeto" name="pipeto" class="anchor"><span class="anchor-link"></span></a>pipeTo</h2>
<p><code>pipeTo</code> is typically used together with <code>ask</code> in an actor. The <code>ask</code> method of the <code>ActorContext</code> in Typed removes the need for <code>pipeTo</code>. However, for interactions with other APIs that return <span class="group-scala"><code>Future</code></span><span class="group-java"><code>CompletionStage</code></span> it is still useful to send the result as a message to the actor. For this purpose there is a <code>pipeToSelf</code> method in the <code>ActorContext</code> in Typed.</p>
<h2><a href="#actorcontext-children" name="actorcontext-children" class="anchor"><span class="anchor-link"></span></a>ActorContext.children</h2>
<p>The <code>ActorContext</code> has methods <span class="group-scala"><code>children</code> and <code>child</code></span><span class="group-java"><code>getChildren</code> and <code>getChild</code></span> to retrieve the <code>ActorRef</code> of started child actors in both Typed and Classic.</p>
<p>The type of the returned <code>ActorRef</code> is unknown, since different types can be used for different children. Therefore, this is not a useful way to lookup children when the purpose is to send messages to them.</p>
<p>Instead of finding children via the <code>ActorContext</code>, it is recommended to use an application specific collection for bookkeeping of children, such as a <span class="group-scala"><code>Map[String, ActorRef[Child.Command]]</code></span> <span class="group-java"><code>Map&lt;String, ActorRef&lt;Child.Command&gt;&gt;</code></span>. It can look like this:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/actor-typed-tests/src/test/scala/docs/org/apache/pekko/typed/fromclassic/TypedSample.scala#L49-L78" target="_blank" title="Go to snippet source">source</a><code class="language-scala">object Parent {
  sealed trait Command
  case class DelegateToChild(name: String, message: Child.Command) extends Command
  private case class ChildTerminated(name: String) extends Command

  def apply(): Behavior[Command] = {
    def updated(children: Map[String, ActorRef[Child.Command]]): Behavior[Command] = {
      Behaviors.receive { (context, command) =&gt;
        command match {
          case DelegateToChild(name, childCommand) =&gt;
            children.get(name) match {
              case Some(ref) =&gt;
                ref ! childCommand
                Behaviors.same
              case None =&gt;
                val ref = context.spawn(Child(), name)
                context.watchWith(ref, ChildTerminated(name))
                ref ! childCommand
                updated(children + (name -&gt; ref))
            }

          case ChildTerminated(name) =&gt;
            updated(children - name)
        }
      }
    }

    updated(Map.empty)
  }
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/actor-typed-tests/src/test/java/jdocs/org/apache/pekko/typed/fromclassic/TypedSample.java#L76-L131" target="_blank" title="Go to snippet source">source</a><code class="language-java">public class Parent extends AbstractBehavior&lt;Parent.Command&gt; {

  public interface Command {}

  public static class DelegateToChild implements Command {
    public final String name;
    public final Child.Command message;

    public DelegateToChild(String name, Child.Command message) {
      this.name = name;
      this.message = message;
    }
  }

  private static class ChildTerminated implements Command {
    final String name;

    ChildTerminated(String name) {
      this.name = name;
    }
  }

  public static Behavior&lt;Command&gt; create() {
    return Behaviors.setup(Parent::new);
  }

  private Map&lt;String, ActorRef&lt;Child.Command&gt;&gt; children = new HashMap&lt;&gt;();

  private Parent(ActorContext&lt;Command&gt; context) {
    super(context);
  }

  @Override
  public Receive&lt;Command&gt; createReceive() {
    return newReceiveBuilder()
        .onMessage(DelegateToChild.class, this::onDelegateToChild)
        .onMessage(ChildTerminated.class, this::onChildTerminated)
        .build();
  }

  private Behavior&lt;Command&gt; onDelegateToChild(DelegateToChild command) {
    ActorRef&lt;Child.Command&gt; ref = children.get(command.name);
    if (ref == null) {
      ref = getContext().spawn(Child.create(), command.name);
      getContext().watchWith(ref, new ChildTerminated(command.name));
      children.put(command.name, ref);
    }
    ref.tell(command.message);
    return this;
  }

  private Behavior&lt;Command&gt; onChildTerminated(ChildTerminated command) {
    children.remove(command.name);
    return this;
  }
}</code></pre></dd>
</dl>
<p>Remember to remove entries from the <code>Map</code> when the children are terminated. For that purpose it&rsquo;s convenient to use <code>watchWith</code>, as illustrated in the example above, because then you can include the key to the <code>Map</code> in the termination message. In that way the name of the actor doesn&rsquo;t have to be the same as identifier used for bookkeeping.</p>
<p>Retrieving the children from the <code>ActorContext</code> can still be useful for some use cases, such as:</p>
<ul>
  <li>see if a child name is in use</li>
  <li>stopping children</li>
  <li>the type of the child is well known and <code>unsafeUpcast</code> of the <code>ActorRef</code> is considered &ldquo;safe enough&rdquo;</li>
</ul>
<h2><a href="#remote-deployment" name="remote-deployment" class="anchor"><span class="anchor-link"></span></a>Remote deployment</h2>
<p>Starting an actor on a remote node—so called remote deployment—isn&rsquo;t supported in Typed.</p>
<p>This feature would be discouraged because it often results in tight coupling between nodes and undesirable failure handling. For example if the node of the parent actor crashes, all remote deployed child actors are brought down with it. Sometimes, that can be desired but many times it is used without realizing. This can be achieved by other means, such as using <code>watch</code>.</p>
<h2><a href="#routers" name="routers" class="anchor"><span class="anchor-link"></span></a>Routers</h2>
<p>Routers are provided in Typed, but in a much simplified form compared to the classic routers.</p>
<p>Destinations of group routers are registered in the <code>Receptionist</code>, which makes them Cluster aware and also more dynamic than classic group routers.</p>
<p>Pool routers are only for local actor destinations in Typed, since <a href="from-classic.html#remote-deployment">remote deployment isn&rsquo;t supported</a>.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../routing.html">Classic</a></li>
  <li><a href="routers.html">Typed</a></li>
</ul>
<h2><a href="#fsm" name="fsm" class="anchor"><span class="anchor-link"></span></a>FSM</h2>
<p>With classic actors there is explicit support for building Finite State Machines. No support is needed in Pekko Typed as it is straightforward to represent FSMs with behaviors.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../fsm.html">Classic</a></li>
  <li><a href="fsm.html">Typed</a></li>
</ul>
<h2><a href="#timers" name="timers" class="anchor"><span class="anchor-link"></span></a>Timers</h2>
<p>In classic actors you <span class="group-scala">mixin <code>with Timers</code></span><span class="group-java"><code>extend AbstractActorWithTimers</code></span> to gain access to delayed and periodic scheduling of messages. In Typed you have access to similar capabilities via <code>Behaviors.withTimers</code>.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../actors.html#actors-timers">Classic</a></li>
  <li><a href="interaction-patterns.html#scheduling-messages-to-self">Typed</a></li>
</ul>
<h2><a href="#stash" name="stash" class="anchor"><span class="anchor-link"></span></a>Stash</h2>
<p>In classic actors you <span class="group-scala">mixin <code>with Stash</code></span><span class="group-java"><code>extend AbstractActorWithStash</code></span> to gain access to stashing of messages. In Typed you have access to similar capabilities via <code>Behaviors.withStash</code>.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../actors.html#stash">Classic</a></li>
  <li><a href="stash.html">Typed</a></li>
</ul>
<h2><a href="#persistentactor" name="persistentactor" class="anchor"><span class="anchor-link"></span></a>PersistentActor</h2>
<p>The correspondence of the classic <code>PersistentActor</code> is <span class="group-scala"><code>org.apache.pekko.persistence.typed.scaladsl.EventSourcedBehavior</code></span><span class="group-java"><code>org.apache.pekko.persistence.typed.javadsl.EventSourcedBehavior</code></span>.</p>
<p>The Typed API is much more guided to facilitate Event Sourcing best practices. It also has tighter integration with Cluster Sharding.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../persistence.html">Classic</a></li>
  <li><a href="persistence.html">Typed</a></li>
</ul>
<h2><a href="#asynchronous-testing" name="asynchronous-testing" class="anchor"><span class="anchor-link"></span></a>Asynchronous Testing</h2>
<p>The Test Kits for asynchronous testing are rather similar.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../testing.html#async-integration-testing">Classic</a></li>
  <li><a href="testing-async.html#asynchronous-testing">Typed</a></li>
</ul>
<h2><a href="#synchronous-testing" name="synchronous-testing" class="anchor"><span class="anchor-link"></span></a>Synchronous Testing</h2>
<p>Classic and typed have different Test Kits for synchronous testing.</p>
<p>Behaviors in Typed can be tested in isolation without having to be packaged into an actor. As a consequence, tests can run fully synchronously without having to worry about timeouts and spurious failures.</p>
<p>The <code>BehaviorTestKit</code> provides a nice way of unit testing a <code>Behavior</code> in a deterministic way, but it has some limitations to be aware of. Similar limitations exists for synchronous testing of classic actors.</p>
<p>Links to reference documentation:</p>
<ul>
  <li><a href="../testing.html#sync-testing">Classic</a></li>
  <li><a href="testing-sync.html#synchronous-behavior-testing">Typed</a></li>
</ul>
</div>
<div>
<a href="https://github.com/apache/incubator-pekko/tree/main/docs/src/main/paradox/typed/from-classic.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.0.0+26605-0f20b284+20230301-2309*
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../typed/style-guide.html" title="Style guide" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Style guide
</span>
</div>
</a>
<a href="../typed/index-cluster.html" title="Cluster" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Cluster
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
Copyright © 2022, 2023 <a href="https://apache.org">The Apache Software Foundation</a>, Licensed under the Apache License, Version 2.0.
 This product contains significant parts that were originally based on software from Lightbend (<a href="https://akka.io/">Akka</a>).
 Copyright (C) 2009-2022 Lightbend Inc. &lt;https://www.lightbend.com&gt; Apache Pekko is derived from Akka 2.6.x,
 the last version that was distributed under the Apache License, Version 2.0 License.
</div>
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="../assets/javascripts/application.583bbe55.js"></script>
<script src="../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../."}})</script>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../assets/javascripts/groups.js"></script>

<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
